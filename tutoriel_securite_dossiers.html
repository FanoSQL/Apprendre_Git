<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√©curit√© des Dossiers Web | Css Manager</title>
    <style>
        /* --- CSS GLOBAL --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.7;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 40px;
            overflow-x: auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
        }

        .toc {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 40px;
            border-left: 5px solid #667eea;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .toc h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }

        .toc li {
            margin-bottom: 10px;
        }

        .toc a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toc a:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        .section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 40px;
            border-left: 5px solid #764ba2;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-number {
            background: #764ba2;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.5;
        }

        code {
            background: #2d2d2d;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }

        .tip {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .tip strong {
            color: #1565C0;
        }

        .warning {
            background: #fff3e0;
            border-left: 4px solid #FF9800;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .warning strong {
            color: #E65100;
        }

        .note {
            background: #e8f5e8;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .note strong {
            color: #2E7D32;
        }

        .exercise {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .exercise h3 {
            color: #ff9800;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px dashed #ccc;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            h1 {
                font-size: 2rem;
            }
            .subtitle {
                font-size: 1rem;
            }
            .toc {
                padding: 15px;
            }
            .section {
                padding: 20px;
            }
            pre {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê S√©curit√© des Dossiers Web</h1>
            <p class="subtitle">Prot√©gez vos fichiers et vos donn√©es sensibles</p>
        </header>

        <div class="toc">
            <h2>üìã Sommaire</h2>
            <ul>
                <li><a href="#intro"><span class="section-number">1</span> Introduction</a></li>
                <li><a href="#pourquoi"><span class="section-number">2</span> Pourquoi Prot√©ger les Dossiers ?</a></li>
                <li><a href="#risques"><span class="section-number">3</span> Risques Associ√©s</a></li>
                <li><a href="#bonnes-pratiques"><span class="section-number">4</span> Bonnes Pratiques de S√©curit√©</a></li>
                <li><a href="#apache"><span class="section-number">5</span> Protection avec Apache (.htaccess)</a></li>
                <li><a href="#php"><span class="section-number">6</span> Protection avec PHP</a></li>
                <li><a href="#structure"><span class="section-number">7</span> Structure de Dossiers Recommand√©e</a></li>
                <li><a href="#exercices"><span class="section-number">8</span> Exercices Pratiques</a></li>
            </ul>
        </div>

        <div class="section" id="intro">
            <h2><span class="section-number">1</span> üìò Introduction</h2>
            <p>La s√©curit√© d'une application web ne se limite pas au code PHP ou aux requ√™tes SQL. Elle inclut aussi la **protection des dossiers et des fichiers** stock√©s sur le serveur.</p>
            <p>Si un dossier ou un fichier sensible est accessible publiquement, un attaquant peut :</p>
            <ul>
                <li>Lire vos **fichiers de configuration** (contenant des mots de passe).</li>
                <li>T√©l√©charger des **documents confidentiels** (listes de clients, factures).</li>
                <li>Ex√©cuter des **scripts malveillants** t√©l√©charg√©s.</li>
            </ul>
            <div class="tip">
                <strong>üí° Objectif :</strong> Apprendre √† prot√©ger les dossiers et les fichiers sensibles de votre application web.
            </div>
        </div>

        <div class="section" id="pourquoi">
            <h2><span class="section-number">2</span> üß† Pourquoi Prot√©ger les Dossiers ?</h2>
            <p>Les dossiers de votre application contiennent souvent des ressources critiques :</p>
            <ul>
                <li><strong>Fichiers de configuration</strong> : <b>config.php</b>, <b>.env</b>, <b>database.ini</b> (contiennent des mots de passe).</li>
                <li><strong>Fichiers de donn√©es</strong> : <b>.sql</b>, <b>.json</b>, <b>.csv</b> (contenant des donn√©es sensibles).</li>
                <li><strong>Fichiers d'upload</strong> : <b>upload/</b>, <b>photos_clients/</b>, <b>cv/</b> (doivent √™tre g√©r√©s avec soin).</li>
                <li><strong>Fichiers de logs</strong> : <b>logs/error.log</b> (contiennent des traces d'erreurs ou de requ√™tes).</li>
            </ul>
            <div class="warning">
                <strong>‚ö†Ô∏è Risque :</strong> Si ces dossiers ne sont pas prot√©g√©s, les attaquants peuvent acc√©der √† des donn√©es confidentielles ou exploiter des failles.
            </div>
        </div>

        <div class="section" id="risques">
            <h2><span class="section-number">3</span> üö® Risques Associ√©s</h2>
            <table>
                <thead>
                    <tr>
                        <th>Risque</th>
                        <th>Description</th>
                        <th>Exemple de Fichier/Dossier</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Vol de mots de passe</td>
                        <td>Acc√®s √† un fichier de configuration contenant des identifiants de base de donn√©es.</td>
                        <td><b>config/database.php</b></td>
                    </tr>
                    <tr>
                        <td>Exposition de donn√©es sensibles</td>
                        <td>T√©l√©chargement d'une base de donn√©es brute ou d'une liste de clients.</td>
                        <td><b>data/backup.sql</b>, <b>documents/liste_clients.csv</b></td>
                    </tr>
                    <tr>
                        <td>Injection de code malveillant</td>
                        <td>Un attaquant t√©l√©charge un script PHP dans un dossier d'upload et l'ex√©cute.</td>
                        <td><b>upload/</b> (si non s√©curis√©)</td>
                    </tr>
                    <tr>
                        <td>Divulgation d'erreurs syst√®me</td>
                        <td>Acc√®s aux logs peut r√©v√©ler des d√©tails techniques.</td>
                        <td><b>logs/error.log</b></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section" id="bonnes-pratiques">
            <h2><span class="section-number">4</span> ‚úÖ Bonnes Pratiques de S√©curit√©</h2>
            <ul>
                <li><strong>Ne placez jamais de fichiers sensibles dans le dossier racine web</strong> (ex: `www`, `htdocs`).</li>
                <li><strong>Utilisez des dossiers en dehors de la racine web</strong> pour les configurations ou les sauvegardes.</li>
                <li><strong>Restreignez l'acc√®s aux dossiers critiques</strong> via des r√®gles de serveur ou du code PHP.</li>
                <li><strong>Validez et filtrez les fichiers t√©l√©charg√©s</strong> (type MIME, extension, taille).</li>
                <li><strong>D√©sactivez le listing des fichiers</strong> dans les dossiers non prot√©g√©s.</li>
                <li><strong>Utilisez des noms de dossiers non √©vidents</strong> pour les zones sensibles (ex: `private_data` au lieu de `backup`).</li>
            </ul>
        </div>

        <div class="section" id="apache">
            <h2><span class="section-number">5</span> üîß Protection avec Apache (.htaccess)</h2>
            <p>Sur les serveurs Apache, vous pouvez utiliser un fichier <b>.htaccess</b> pour bloquer l'acc√®s √† un dossier ou √† certains types de fichiers.</p>

            <h3>Exemple 1 : Bloquer l'acc√®s √† un dossier entier</h3>
            <p>Cr√©ez un fichier nomm√© <b>.htaccess</b> dans le dossier que vous voulez prot√©ger (ex: `config/` ou `data/`).</p>
            <pre><code># .htaccess
# Bloquer l'acc√®s √† tous les fichiers du dossier
Order Deny,Allow
Deny from all</code></pre>

            <h3>Exemple 2 : Bloquer l'acc√®s √† des types de fichiers sp√©cifiques</h3>
            <pre><code># .htaccess
# Bloquer l'acc√®s aux fichiers .env et .sql
<Files "*.env">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.sql">
    Order Deny,Allow
    Deny from all
</Files></code></pre>

            <h3>Exemple 3 : D√©sactiver le listing des fichiers</h3>
            <pre><code># .htaccess
# D√©sactiver l'affichage de la liste des fichiers
Options -Indexes</code></pre>

            <div class="note">
                <strong>‚úÖ Astuce :</strong> Le fichier <b>.htaccess</b> s'applique au **dossier o√π il est plac√©** et √† **tous ses sous-dossiers**.
            </div>
        </div>

        <div class="section" id="php">
            <h2><span class="section-number">6</span> üîê Protection avec PHP</h2>
            <p>Vous pouvez aussi g√©rer l'acc√®s aux fichiers via du code PHP.</p>

            <h3>Exemple 1 : Servir un fichier priv√© en fonction de l'utilisateur connect√©</h3>
            <pre><code>< ? php
session_start();

// V√©rifier si l'utilisateur est connect√© et autoris√©
if (!isset($_SESSION['user_id']) || $_SESSION['role'] !== 'admin') {
    die("Acc√®s refus√©.");
}

// R√©cup√©rer le nom du fichier demand√©
$filename = $_GET['f'] ?? '';
if (empty($filename)) {
    die("Fichier non sp√©cifi√©.");
}

// S√©curit√© : Emp√™cher la travers√©e de dossiers (ex: ../../config.php)
$filename = basename($filename);

// Chemin vers le fichier dans un dossier priv√©
$filePath = __DIR__ . '/private_documents/' . $filename;

// V√©rifier que le fichier existe et est dans le bon dossier
if (!file_exists($filePath) || strpos(realpath($filePath), realpath(__DIR__ . '/private_documents/')) !== 0) {
    die("Fichier non trouv√© ou non autoris√©.");
}

// Envoyer le fichier au navigateur
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename="' . basename($filePath) . '"');
readfile($filePath);
exit;
? ></code></pre>

            <h3>Exemple 2 : Valider un t√©l√©chargement de fichier via formulaire</h3>
            <pre><code>< ? php
if ($_POST && isset($_FILES['fichier'])) {
    $file = $_FILES['fichier'];
    $uploadDir = 'uploads/';
    $allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'];

    if ($file['error'] === UPLOAD_ERR_OK) {
        $fileType = mime_content_type($file['tmp_name']);
        $fileExtension = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));

        if (in_array($fileType, $allowedTypes) && $fileExtension !== 'php') {
            $destination = $uploadDir . basename($file['name']);
            if (move_uploaded_file($file['tmp_name'], $destination)) {
                echo "‚úÖ Fichier t√©l√©charg√© avec succ√®s.";
            } else {
                echo "‚ùå Erreur lors du d√©placement du fichier.";
            }
        } else {
            echo "‚ùå Type de fichier non autoris√© ou danger (PHP).";
        }
    } else {
        echo "‚ùå Erreur de t√©l√©chargement.";
    }
}
? ></code></pre>

            <div class="tip">
                <strong>üí° Astuce :</strong> Utilisez <b>basename()</b> pour emp√™cher les attaques de type "travers√©e de dossiers".
            </div>
        </div>

        <div class="section" id="structure">
            <h2><span class="section-number">7</span> üèóÔ∏è Structure de Dossiers Recommand√©e</h2>
            <p>Voici une structure de projet qui s√©pare les fichiers sensibles du dossier accessible publiquement.</p>
            <pre><code>/mon_projet/
‚îÇ
‚îú‚îÄ‚îÄ public/                 # Contenu accessible via le web (index.php, assets, uploads)
‚îÇ   ‚îú‚îÄ‚îÄ index.php
‚îÇ   ‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ uploads/            # Fichiers upload√©s (√† s√©curiser)
‚îÇ       ‚îú‚îÄ‚îÄ photos_clients/
‚îÇ       ‚îî‚îÄ‚îÄ documents/
‚îÇ
‚îú‚îÄ‚îÄ private/                # Contenu non accessible via le web
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db.php          # Fichier de configuration (mots de passe, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error.log
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backup.sql
‚îÇ   ‚îî‚îÄ‚îÄ includes/
‚îÇ       ‚îî‚îÄ‚îÄ functions.php
‚îÇ
‚îî‚îÄ‚îÄ vendor/                 # D√©pendances (ex: Composer)</code></pre>
            <p>Dans cette structure, seul le dossier <b>public/</b> est expos√© √† l'URL racine du serveur web.</p>
        </div>

        <div class="section" id="exercices">
            <h2><span class="section-number">8</span> üìù Exercices Pratiques</h2>

            <div class="exercise">
                <h3>Exercice 1 : Cr√©er un .htaccess de s√©curit√©</h3>
                <p>Cr√©ez un dossier <b>config</b> dans votre projet et placez-y un fichier <b>.htaccess</b> pour emp√™cher l'acc√®s √† tous les fichiers du dossier.</p>
            </div>

            <div class="exercise">
                <h3>Exercice 2 : Servir un fichier priv√© avec PHP</h3>
                <p>Cr√©ez un script PHP (<b>download.php</b>) qui v√©rifie si l'utilisateur est connect√© avant de servir un fichier PDF depuis un dossier priv√©.</p>
            </div>

            <div class="exercise">
                <h3>Exercice 3 : Valider un fichier upload√©</h3>
                <p>Cr√©ez un formulaire d'upload et un script PHP qui v√©rifie le type MIME et l'extension du fichier. Refusez les fichiers PHP ou ex√©cutables.</p>
            </div>

            <div class="exercise">
                <h3>Exercice 4 : D√©sactiver le listing des fichiers</h3>
                <p>Ajoutez la directive <b>Options -Indexes</b> dans un fichier <b>.htaccess</b> √† la racine de votre dossier d'uploads. V√©rifiez que vous ne pouvez plus voir la liste des fichiers.</p>
            </div>

            <div class="exercise">
                <h3>Exercice 5 : Prot√©ger un dossier de sauvegarde</h3>
                <p>Cr√©ez un dossier <b>backup</b> dans votre projet et prot√©gez-le avec un <b>.htaccess</b> qui interdit l'acc√®s.</p>
            </div>
        </div>

        <footer>
            <p>¬© St√©phane MONTET 2024 - Css Manager - Plateforme √âducative pour √âtudiants</p>
            <p>S√©curisez vos applications web d√®s la conception !</p>
        </footer>
    </div>
</body>
</html>